---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { useTranslationsFromAstro } from '../../i18n/utils';
import es from '../../i18n/locales/es.json';
import en from '../../i18n/locales/en.json';

import ContactCTA from '../../components/ContactCTA.astro';
import Hero from '../../components/Hero.astro';

// Obtener parámetros de la ruta
export function getStaticPaths() {
  return [
    { params: { lang: 'es' } },
    { params: { lang: 'en' } },
  ];
}

// Extraer el parámetro de idioma para uso en rutas
const { lang } = Astro.params;

// Usar la función simplificada para obtener traducciones
const t = useTranslationsFromAstro(Astro);

// Obtener datos del JSON según el idioma
const translations = lang === 'es' ? es : en;

// Título y descripción de la página
const pageTitle = `${t('about.title')} | Aaron Ccenta`;
const pageDescription = t('site.description');
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <div class="stack gap-20">
    <main class="wrapper about">
      <Hero
        title={t('about.title')}
        tagline={t('about.tagline')}
      >
        <img
          width="1553"
          height="873"
          src="/assets/at-work.jpg"
          alt="Aaron Ccenta at work"
        />
      </Hero>

      <section>
        <h2 class="section-title">{t('about.background.title')}</h2>
        <div class="content">
          <p>{t('about.background.p1')}</p>
          <p>{t('about.background.p2')}</p>
          <p>{t('about.background.p3')}</p>
        </div>
      </section>

      <section>
        <h2 class="section-title">{t('about.education.title')}</h2>
        <div class="content">
          <p>{t('about.education.degree')}</p>
        </div>
      </section>

      <section>
        <h2 class="section-title">{t('about.skills.title')}</h2>
        <div class="content">
          {translations.about.skills.categories.map((category) => (
            <p><strong>{category.title}:</strong> {category.skills}</p>
          ))}
        </div>
      </section>

      <section>
        <h2 class="section-title">{t('about.experience.title')}</h2>
        <div class="content">
          {translations.about.experience.jobs.map((job, index) => (
            <div class="job-entry">
              <p class="job-header">
                <strong>{job.title}</strong> | {job.company} ({job.period})
              </p>
              {job.tags && (
                <div class="tags">
                  {job.tags.map((tag) => (
                    <span class="tag">{tag}</span>
                  ))}
                </div>
              )}
              <ul>
                {job.responsibilities.map((resp) => (
                  <li>{resp}</li>
                ))}
              </ul>
            </div>
          ))}
        </div>
      </section>
    </main>

    <ContactCTA />
  </div>
</BaseLayout>

<style>
  .about {
    display: flex;
    flex-direction: column;
    gap: 3.5rem;
  }

  img {
    margin-top: 1.5rem;
    border-radius: 1.5rem;
    box-shadow: var(--shadow-md);
  }

  section {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    color: var(--gray-200);
  }

  .section-title {
    grid-column-start: 1;
    font-size: var(--text-xl);
    color: var(--gray-0);
  }

  .content {
    grid-column: 2 / 4;
  }

  .job-entry {
    margin-bottom: 2rem;
  }

  .job-header {
    font-size: 1.1rem;
    margin-bottom: 0.5rem;
  }

  .tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin: 0.75rem 0;
  }

  .tag {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    font-size: 0.75rem;
    font-weight: 500;
    background: var(--accent-overlay);
    color: var(--accent-text-over);
    border-radius: 0.5rem;
  }

  .content :global(a) {
    text-decoration: 1px solid underline transparent;
    text-underline-offset: 0.25em;
    transition: text-decoration-color var(--theme-transition);
  }

  .content :global(a:hover),
  .content :global(a:focus) {
    text-decoration-color: currentColor;
  }

  ul {
    margin-top: 0.5rem;
    margin-left: 1.5rem;
  }

  li {
    margin-bottom: 0.5rem;
  }

  @media (min-width: 50em) {
    .about {
      display: grid;
      grid-template-columns: 1fr 60% 1fr;
    }

    .about > :global(*) {
      grid-column: 2;
    }

    section {
      display: contents;
      font-size: var(--text-lg);
    }
  }
</style>
